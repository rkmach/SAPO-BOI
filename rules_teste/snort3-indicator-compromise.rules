# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2007 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2007 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#----------------------------
# INDICATOR-COMPROMISE RULES
#----------------------------
# fast_pattern's 'only' option has been deleted

alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE command completed"; flow:established; content:"Command completed",fast_pattern,nocase; pcre:"/^Command\s+?completed\b/ms"; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,1806; reference:cve,2000-0884; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-078; classtype:bad-unknown; sid:494; rev:21; )
alert udp $EXTERNAL_NET any -> $HOME_NET [21,80] ( msg:"INDICATOR-COMPROMISE FTP 'CWD / ' possible warez site"; flow:to_server,established; content:"CWD",nocase; content:"/ ",distance 1; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:666; rev:9; )
alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE command error"; flow:established; content:"Bad command or filename",nocase; metadata:ruleset community; service:http; classtype:bad-unknown; sid:495; rev:14; )
alert tcp $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET 25 ( msg:"INDICATOR-COMPROMISE file copied ok"; flow:to_client,established; file_data; content:"1 file|28|s|29| copied",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,1806; reference:cve,2000-0884; classtype:bad-unknown; sid:497; rev:21; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,80] ( msg:"INDICATOR-COMPROMISE FTP 'STOR 1MB' possible warez site"; flow:to_server,established; content:"STOR",nocase; content:"1MB",distance 1,nocase; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:543; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25] ( msg:"INDICATOR-COMPROMISE FTP 'RETR 1MB' possible warez site"; flow:to_server,established; content:"RETR",nocase; content:"1MB",distance 1,nocase; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:544; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,80] ( msg:"INDICATOR-COMPROMISE FTP 'CWD / ' possible warez site"; flow:to_server,established; content:"CWD",nocase; content:"/ ",distance 1; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:545; rev:9; )
